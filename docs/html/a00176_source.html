<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACA: ToolResample.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ACA<span id="projectnumber">&#160;0.2.3</span>
   </div>
   <div id="projectbrief">Example Code for Audio Content Analysis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bfccd401955b95cf8c75461437045ac0.html">inc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">ToolResample.h</div></div>
</div><!--header-->
<div class="contents">
<a href="a00176.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#if !defined(__Resample_hdr__)</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#define __Resample_hdr__</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &quot;<a class="code" href="a00104.html">ErrorDef.h</a>&quot;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &quot;<a class="code" href="a00125.html">Filter.h</a>&quot;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &quot;<a class="code" href="a00134.html">Util.h</a>&quot;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"></span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">/*! \brief class for simple interpolation/sample rate conversion</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">*/</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno"><a class="line" href="a00539.html">   11</a></span><span class="keyword">class </span><a class="code hl_class" href="a00539.html">CResample</a></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>{</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"></span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">    /*! simple linear interpolation, static function can be used without instantiation</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">    \param pfOut buffer with interpolated output samples (user allocated of length iNumOutSamples)</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">    \param pfNewIdx indication of location of outputs on the input index scale, e.g., if the output sample rate is 3x the input sample rate, this vector will start with 0, 0.33, 0.66, 1, 1.33, ...</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">    \param pfIn original samples</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">    \param iNumOutSamples length of pfOut and pfNewIdx</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment">    \param iNumInSamples length of pfIn</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">    \return Error_t</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment">    */</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="a00539.html#a02a81c6177894649b0524b684118839e">   24</a></span>    <span class="keyword">static</span> <a class="code hl_enumeration" href="a00104.html#a4e8c0d09726859e3d3369c0da5a1aa7f">Error_t</a> <a class="code hl_function" href="a00539.html#a02a81c6177894649b0524b684118839e">interp1d</a>(<span class="keywordtype">float</span>* pfOut, <span class="keyword">const</span> <span class="keywordtype">float</span>* pfNewIdx, <span class="keyword">const</span> <span class="keywordtype">float</span>* pfIn, <span class="keywordtype">long</span> <span class="keywordtype">long</span> iNumOutSamples, <span class="keywordtype">long</span> <span class="keywordtype">long</span> iNumInSamples)</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    {</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>        <span class="keywordflow">if</span> (!pfNewIdx || !pfOut || !pfIn || iNumInSamples &lt;= 0 || iNumOutSamples &lt;= 0)</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="a00104.html#a4e8c0d09726859e3d3369c0da5a1aa7fa819a1ca163e9ca86f941b0b072a9a248">Error_t::kFunctionInvalidArgsError</a>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> iStart = 0,</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>            iEnd = iNumOutSamples - 1;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>        <span class="comment">// treat first samples</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>        <span class="keywordflow">while</span> ((iStart &lt; iNumOutSamples) &amp;&amp; (pfNewIdx[iStart] &lt; 0))</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>        {</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>            <span class="keywordflow">if</span> (pfNewIdx[iStart] &lt; -1)</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>                pfOut[iStart] = 0;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>            {</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>                <span class="keywordtype">int</span>     iIdx = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(pfNewIdx[iStart]));</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>                <span class="keywordtype">float</span>   fFrac = pfNewIdx[iStart] - iIdx;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>                pfOut[iStart] = fFrac * pfIn[0];</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>            }</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>            iStart++;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>        }</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>        <span class="comment">// treat last samples</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        <span class="keywordflow">while</span> ((pfNewIdx[iEnd] &gt; iNumInSamples - 1) &amp;&amp; (iEnd &gt;= 0))</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>        {</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>            <span class="keywordflow">if</span> (pfNewIdx[iEnd] &gt; iNumInSamples)</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>                pfOut[iEnd] = 0;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>            {</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>                <span class="keywordtype">int</span>     iIdx = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(pfNewIdx[iEnd]));</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>                <span class="keywordtype">float</span>   fFrac = pfNewIdx[iEnd] - iIdx;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>                pfOut[iEnd] = (1 - fFrac) * pfIn[iNumInSamples - 1];</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>            }</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>            iEnd--;</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>        }</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        <span class="comment">// now go through the buffer</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = iStart; i &lt;= iEnd; i++)</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>        {</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>            <span class="keywordtype">int</span>     iIdx = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::floor(pfNewIdx[i]));</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>            <span class="keywordtype">float</span>   fFrac = pfNewIdx[i] - iIdx;</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>            pfOut[i] = (1 - fFrac) * pfIn[iIdx] + fFrac * pfIn[iIdx + 1];</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>        }</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="a00104.html#a4e8c0d09726859e3d3369c0da5a1aa7fafcd1af9ec66cb99f2d106d7fdc865c8b">Error_t::kNoError</a>;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    }</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="a00539.html#a6af73d34704579d5d18ef456fe54a983">   72</a></span>    <span class="keyword">explicit</span> <a class="code hl_function" href="a00539.html#a6af73d34704579d5d18ef456fe54a983">CResample</a>(<span class="keywordtype">float</span> fInSampleRate, <span class="keywordtype">float</span> fOutSampleRate) :</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        <a class="code hl_variable" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">m_fInSampleRate</a>(fInSampleRate),</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        <a class="code hl_variable" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">m_fOutSampleRate</a>(fOutSampleRate)</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    {</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        assert(<a class="code hl_variable" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">m_fInSampleRate</a> &gt; 0);</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        assert(<a class="code hl_variable" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">m_fOutSampleRate</a> &gt; 0);</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        <a class="code hl_variable" href="a00539.html#ad227a6fd0acf022e8a41a1d4ab2b27c9">m_pCFilter</a> = <span class="keyword">new</span> <a class="code hl_class" href="a00435.html">CFilter&lt;float&gt;</a>();</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    }</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno"><a class="line" href="a00539.html#abf7624c3daf78a13e5bb949a242c3034">   82</a></span>    <span class="keyword">virtual</span> <a class="code hl_function" href="a00539.html#abf7624c3daf78a13e5bb949a242c3034">~CResample</a>() </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    {</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        <span class="keyword">delete</span> <a class="code hl_variable" href="a00539.html#ad227a6fd0acf022e8a41a1d4ab2b27c9">m_pCFilter</a>;</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    }</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="comment"></span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="comment">    /*! returns the length of the output in case of iNumInSamples as input</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="comment">    \return long long</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="comment">    */</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno"><a class="line" href="a00539.html#a1fa6003e640ba66531236277eddc5158">   91</a></span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code hl_function" href="a00539.html#a1fa6003e640ba66531236277eddc5158">getOutputLength</a>(<span class="keywordtype">long</span> <span class="keywordtype">long</span> iNumInSamples)<span class="keyword"> const</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="keywordflow">return</span> CUtil::float2int&lt;long long&gt;(iNumInSamples/<a class="code hl_variable" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">m_fInSampleRate</a>*<a class="code hl_variable" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">m_fOutSampleRate</a>);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    }</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span><span class="comment"></span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="comment">    /*! does the sample rate conversion (filtered linear interpolation)</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="comment">    \param pfOut output buffer (to be written, user allocated, length see CResample::getOutputLength)</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><span class="comment">    \param pfIn input buffer of length iNumInSamples</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="comment">    \param iNumInSamples length of input buffer</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="comment">    \return Error_t</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="comment">    */</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="a00539.html#a040a6674ec0ff9171d6b4cb4b8436cb2">  102</a></span>    <a class="code hl_enumeration" href="a00104.html#a4e8c0d09726859e3d3369c0da5a1aa7f">Error_t</a> <a class="code hl_function" href="a00539.html#a040a6674ec0ff9171d6b4cb4b8436cb2">process</a>(<span class="keywordtype">float</span> *pfOut, <span class="keyword">const</span> <span class="keywordtype">float</span> *pfIn, <span class="keywordtype">long</span> <span class="keywordtype">long</span> iNumInSamples)</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    {</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>        <span class="keywordflow">if</span> (!pfOut || !pfIn || iNumInSamples &lt;= 0)</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="a00104.html#a4e8c0d09726859e3d3369c0da5a1aa7fa819a1ca163e9ca86f941b0b072a9a248">Error_t::kFunctionInvalidArgsError</a>;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> iOrder = 4;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>        <span class="keywordtype">float</span> fOmegaCutoff = (<a class="code hl_variable" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">m_fOutSampleRate</a> &gt; <a class="code hl_variable" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">m_fInSampleRate</a>) ? <a class="code hl_variable" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">m_fInSampleRate</a> / <a class="code hl_variable" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">m_fOutSampleRate</a> : <a class="code hl_variable" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">m_fOutSampleRate</a> / <a class="code hl_variable" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">m_fInSampleRate</a>;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>        <span class="comment">// compute index axis</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> iNumOutSamples = <a class="code hl_function" href="a00539.html#a1fa6003e640ba66531236277eddc5158">getOutputLength</a>(iNumInSamples);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>        <span class="keywordtype">float</span>* pfOutIdx = 0;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        <a class="code hl_function" href="a00459.html#abaadac98b1cad18b7b568852bc951696">CVector::alloc</a>(pfOutIdx, iNumOutSamples);</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = 0; i &lt; iNumOutSamples; i++)</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            pfOutIdx[i] = i * <a class="code hl_variable" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">m_fInSampleRate</a> / <a class="code hl_variable" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">m_fOutSampleRate</a>;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        <span class="comment">// compute butterworth low pass filter coefficients</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        <span class="keywordtype">float</span> aafCoeffs[2][iOrder+1] = { 0 };</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        <a class="code hl_function" href="a00439.html#a3878460603a6e6e1a64de6021b2bb73e">CButterLp::calcCoeffs</a>(aafCoeffs[0], aafCoeffs[1], iOrder, .9F * fOmegaCutoff);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <a class="code hl_variable" href="a00539.html#ad227a6fd0acf022e8a41a1d4ab2b27c9">m_pCFilter</a>-&gt;<a class="code hl_function" href="a00435.html#add0db9a0cf605eb3f57c80b52d2bda0e">init</a>(aafCoeffs[0], aafCoeffs[1], iOrder+1);</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">m_fOutSampleRate</a> &gt; <a class="code hl_variable" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">m_fInSampleRate</a>) <span class="comment">// upsample</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        {</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>            <span class="comment">// interpolate</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>            <a class="code hl_function" href="a00539.html#a02a81c6177894649b0524b684118839e">interp1d</a>(pfOut, pfOutIdx, pfIn, iNumOutSamples, iNumInSamples);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span> </div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>            <span class="comment">// apply zero phase filter</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>            <a class="code hl_variable" href="a00539.html#ad227a6fd0acf022e8a41a1d4ab2b27c9">m_pCFilter</a>-&gt;<a class="code hl_function" href="a00435.html#a04bf94ff97e5e270210954864025ea06">filtfilt</a>(pfOut, pfOut, iNumOutSamples);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        }</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        <span class="keywordflow">else</span> <span class="comment">// downsample</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>        {</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>            <span class="keywordtype">float</span>* pfFiltered = 0;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>            <a class="code hl_function" href="a00459.html#abaadac98b1cad18b7b568852bc951696">CVector::alloc</a>(pfFiltered, iNumInSamples);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>            <span class="comment">// apply zero phase filter</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>            <a class="code hl_variable" href="a00539.html#ad227a6fd0acf022e8a41a1d4ab2b27c9">m_pCFilter</a>-&gt;<a class="code hl_function" href="a00435.html#a04bf94ff97e5e270210954864025ea06">filtfilt</a>(pfFiltered, pfIn, iNumInSamples);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>            <span class="comment">// interpolate</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>            <a class="code hl_function" href="a00539.html#a02a81c6177894649b0524b684118839e">interp1d</a>(pfOut, pfOutIdx, pfFiltered, iNumOutSamples, iNumInSamples);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>            <a class="code hl_function" href="a00459.html#aa86bdb0c663d4d52f2765793756f8737">CVector::free</a>(pfFiltered);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>        <span class="comment">// free internal memory</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        <a class="code hl_function" href="a00459.html#aa86bdb0c663d4d52f2765793756f8737">CVector::free</a>(pfOutIdx);</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="a00104.html#a4e8c0d09726859e3d3369c0da5a1aa7fafcd1af9ec66cb99f2d106d7fdc865c8b">Error_t::kNoError</a>;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    }</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno"><a class="line" href="a00539.html#aa35aba2e70d5325d5b3098faa79ba05d">  151</a></span>    <a class="code hl_function" href="a00539.html#aa35aba2e70d5325d5b3098faa79ba05d">CResample</a>(<span class="keyword">const</span> <a class="code hl_class" href="a00539.html">CResample</a>&amp; that);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno"><a class="line" href="a00539.html#a0db33ae459e827fc0258b7b9ae3cf738">  152</a></span>    <a class="code hl_class" href="a00539.html">CResample</a>&amp; <a class="code hl_function" href="a00539.html#a0db33ae459e827fc0258b7b9ae3cf738">operator=</a>(<span class="keyword">const</span> <a class="code hl_class" href="a00539.html">CResample</a>&amp; c);</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno"><a class="line" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">  154</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">m_fInSampleRate</a> = 0.F; <span class="comment">//!&lt; sample rate of input</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno"><a class="line" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">  155</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="a00539.html#a4e704946c8bfe078190cdf36818e40db">m_fOutSampleRate</a> = 0.F; <span class="comment">//!&lt; sample rate of output</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno"><a class="line" href="a00539.html#ad227a6fd0acf022e8a41a1d4ab2b27c9">  157</a></span>    <a class="code hl_class" href="a00435.html">CFilter&lt;float&gt;</a>* <a class="code hl_variable" href="a00539.html#ad227a6fd0acf022e8a41a1d4ab2b27c9">m_pCFilter</a> = 0; <span class="comment">//!&lt; low pass filter processing</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>};</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span> </div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span><span class="preprocessor">#endif </span><span class="comment">// #if !defined(__Resample_hdr__)</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
<div class="ttc" id="aa00104_html"><div class="ttname"><a href="a00104.html">ErrorDef.h</a></div></div>
<div class="ttc" id="aa00104_html_a4e8c0d09726859e3d3369c0da5a1aa7f"><div class="ttname"><a href="a00104.html#a4e8c0d09726859e3d3369c0da5a1aa7f">Error_t</a></div><div class="ttdeci">Error_t</div><div class="ttdef"><b>Definition:</b> <a href="a00104_source.html#l00004">ErrorDef.h:5</a></div></div>
<div class="ttc" id="aa00104_html_a4e8c0d09726859e3d3369c0da5a1aa7fa819a1ca163e9ca86f941b0b072a9a248"><div class="ttname"><a href="a00104.html#a4e8c0d09726859e3d3369c0da5a1aa7fa819a1ca163e9ca86f941b0b072a9a248">Error_t::kFunctionInvalidArgsError</a></div><div class="ttdeci">@ kFunctionInvalidArgsError</div></div>
<div class="ttc" id="aa00104_html_a4e8c0d09726859e3d3369c0da5a1aa7fafcd1af9ec66cb99f2d106d7fdc865c8b"><div class="ttname"><a href="a00104.html#a4e8c0d09726859e3d3369c0da5a1aa7fafcd1af9ec66cb99f2d106d7fdc865c8b">Error_t::kNoError</a></div><div class="ttdeci">@ kNoError</div></div>
<div class="ttc" id="aa00125_html"><div class="ttname"><a href="a00125.html">Filter.h</a></div></div>
<div class="ttc" id="aa00134_html"><div class="ttname"><a href="a00134.html">Util.h</a></div></div>
<div class="ttc" id="aa00435_html"><div class="ttname"><a href="a00435.html">CFilter&lt; float &gt;</a></div></div>
<div class="ttc" id="aa00435_html_a04bf94ff97e5e270210954864025ea06"><div class="ttname"><a href="a00435.html#a04bf94ff97e5e270210954864025ea06">CFilter::filtfilt</a></div><div class="ttdeci">Error_t filtfilt(T *pfOut, const T *pfIn, long long iNumSamples)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00166">Filter.h:166</a></div></div>
<div class="ttc" id="aa00435_html_add0db9a0cf605eb3f57c80b52d2bda0e"><div class="ttname"><a href="a00435.html#add0db9a0cf605eb3f57c80b52d2bda0e">CFilter::init</a></div><div class="ttdeci">Error_t init(const T *pfB, const T *pfA, int iNumCoeffs)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00033">Filter.h:33</a></div></div>
<div class="ttc" id="aa00439_html_a3878460603a6e6e1a64de6021b2bb73e"><div class="ttname"><a href="a00439.html#a3878460603a6e6e1a64de6021b2bb73e">CButterLp::calcCoeffs</a></div><div class="ttdeci">static Error_t calcCoeffs(T *pfB, T *pfA, int iOrder, T fCutOff)</div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00301">Filter.h:301</a></div></div>
<div class="ttc" id="aa00459_html_aa86bdb0c663d4d52f2765793756f8737"><div class="ttname"><a href="a00459.html#aa86bdb0c663d4d52f2765793756f8737">CVector::free</a></div><div class="ttdeci">static void free(T *&amp;ptVec)</div><div class="ttdef"><b>Definition:</b> <a href="a00128_source.html#l00039">Vector.h:39</a></div></div>
<div class="ttc" id="aa00459_html_abaadac98b1cad18b7b568852bc951696"><div class="ttname"><a href="a00459.html#abaadac98b1cad18b7b568852bc951696">CVector::alloc</a></div><div class="ttdeci">static void alloc(T *&amp;ptVec, long long iLength)</div><div class="ttdef"><b>Definition:</b> <a href="a00128_source.html#l00024">Vector.h:24</a></div></div>
<div class="ttc" id="aa00539_html"><div class="ttname"><a href="a00539.html">CResample</a></div><div class="ttdoc">class for simple interpolation/sample rate conversion</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00011">ToolResample.h:12</a></div></div>
<div class="ttc" id="aa00539_html_a02a81c6177894649b0524b684118839e"><div class="ttname"><a href="a00539.html#a02a81c6177894649b0524b684118839e">CResample::interp1d</a></div><div class="ttdeci">static Error_t interp1d(float *pfOut, const float *pfNewIdx, const float *pfIn, long long iNumOutSamples, long long iNumInSamples)</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00024">ToolResample.h:24</a></div></div>
<div class="ttc" id="aa00539_html_a040a6674ec0ff9171d6b4cb4b8436cb2"><div class="ttname"><a href="a00539.html#a040a6674ec0ff9171d6b4cb4b8436cb2">CResample::process</a></div><div class="ttdeci">Error_t process(float *pfOut, const float *pfIn, long long iNumInSamples)</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00102">ToolResample.h:102</a></div></div>
<div class="ttc" id="aa00539_html_a0db33ae459e827fc0258b7b9ae3cf738"><div class="ttname"><a href="a00539.html#a0db33ae459e827fc0258b7b9ae3cf738">CResample::operator=</a></div><div class="ttdeci">CResample &amp; operator=(const CResample &amp;c)</div></div>
<div class="ttc" id="aa00539_html_a1fa6003e640ba66531236277eddc5158"><div class="ttname"><a href="a00539.html#a1fa6003e640ba66531236277eddc5158">CResample::getOutputLength</a></div><div class="ttdeci">long long getOutputLength(long long iNumInSamples) const</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00091">ToolResample.h:91</a></div></div>
<div class="ttc" id="aa00539_html_a4e704946c8bfe078190cdf36818e40db"><div class="ttname"><a href="a00539.html#a4e704946c8bfe078190cdf36818e40db">CResample::m_fOutSampleRate</a></div><div class="ttdeci">float m_fOutSampleRate</div><div class="ttdoc">sample rate of output</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00155">ToolResample.h:155</a></div></div>
<div class="ttc" id="aa00539_html_a6af73d34704579d5d18ef456fe54a983"><div class="ttname"><a href="a00539.html#a6af73d34704579d5d18ef456fe54a983">CResample::CResample</a></div><div class="ttdeci">CResample(float fInSampleRate, float fOutSampleRate)</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00072">ToolResample.h:72</a></div></div>
<div class="ttc" id="aa00539_html_a9d56139a9c202823fe57a189146a9b8c"><div class="ttname"><a href="a00539.html#a9d56139a9c202823fe57a189146a9b8c">CResample::m_fInSampleRate</a></div><div class="ttdeci">float m_fInSampleRate</div><div class="ttdoc">sample rate of input</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00154">ToolResample.h:154</a></div></div>
<div class="ttc" id="aa00539_html_aa35aba2e70d5325d5b3098faa79ba05d"><div class="ttname"><a href="a00539.html#aa35aba2e70d5325d5b3098faa79ba05d">CResample::CResample</a></div><div class="ttdeci">CResample(const CResample &amp;that)</div></div>
<div class="ttc" id="aa00539_html_abf7624c3daf78a13e5bb949a242c3034"><div class="ttname"><a href="a00539.html#abf7624c3daf78a13e5bb949a242c3034">CResample::~CResample</a></div><div class="ttdeci">virtual ~CResample()</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00082">ToolResample.h:82</a></div></div>
<div class="ttc" id="aa00539_html_ad227a6fd0acf022e8a41a1d4ab2b27c9"><div class="ttname"><a href="a00539.html#ad227a6fd0acf022e8a41a1d4ab2b27c9">CResample::m_pCFilter</a></div><div class="ttdeci">CFilter&lt; float &gt; * m_pCFilter</div><div class="ttdoc">low pass filter processing</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00157">ToolResample.h:157</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 7 2022 19:55:53 for ACA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
